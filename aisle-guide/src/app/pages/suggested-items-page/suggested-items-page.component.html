<app-client-header></app-client-header>

<div class="dashboard-container">
    <div class="left-panel">
        <div class="panel-content">
            <div class="panel-header">
                <h2>Favorite Products</h2>
            </div>

            @if(recommendedProducts.length === 0) {
            <div class="empty-state">
                <i class="fa fa-heart-o empty-icon"></i>
                <p>No favorite products yet</p>
                <span>Start adding products to your favorites!</span>
            </div>
            } @else {
            <div class="products-list">
                @if(recommendedProducts.length > 0) {
                <div class="pagination-controls">
                    <button class="btn-pagination" [disabled]="!favoriteCanGoPrev" (click)="favoritePrevPage()">
                        Previous
                    </button>
                    <span class="page-info">Page {{ favoriteCurrentPage }}</span>
                    <button class="btn-pagination" [disabled]="!favoriteCanGoNext" (click)="favoriteNextPage()">
                        Next
                    </button>
                </div>
                }
                @for (product of recommendedProducts; track product.id) {
                <div class="product-card">
                    <div class="product-image">
                        <img [src]="'https://images.unsplash.com/photo-1558961363-fa8fdf82db35?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=400&q=80'"
                            alt="{{ product.name }}">
                        <button class="favorite-btn" (click)="toggleFavorite(product.id)"
                            [class.active]="isFavorite(product.id)">
                            <i class="fa fa-heart"></i>
                        </button>
                    </div>
                    <div class="product-info">
                        <h3>{{ product.name }}</h3>
                        <div class="product-details">
                            <p class="product-price">€ {{ product.price.toFixed(2) }}</p>
                            <p>Category: {{ product.category }}</p>
                            <p>Shelf: {{ product.shelvingUnit || 'Not assigned' }}</p>
                        </div>
                        <div class="product-rating">
                            <span class="star-rating">
                                @for (i of [1, 2, 3, 4, 5]; track i) {
                                <i class="fa" [ngClass]="{
                    'fa-star': i <= Math.floor(product.averageRating || 0),
                    'fa-star-half-o': (i > Math.floor(product.averageRating || 0) && i <= (product.averageRating || 0) + 0.5),
                    'fa-star-o': i > (product.averageRating || 0) + 0.5
                }"></i>
                                }
                            </span>
                            <span class="rating-value">{{ product.averageRating || 'N/A' }}</span>
                        </div>
                        <div class="product-actions">
                            <button class="btn-view-details" (click)="viewProductDetails(product.id)">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
                }
            </div>
            }
        </div>
    </div>

    <div class="right-panel">
        <div class="panel-content">
            <div class="panel-header">
                <h2>Suggested Products</h2>
            </div>

            @if(suggestedProducts.length === 0) {
            <div class="empty-state">
                <i class="fa fa-lightbulb-o empty-icon"></i>
                <p>No suggestions available</p>
                <span>Check back later for recommendations!</span>
            </div>
            } @else {
            <div class="products-list">
                @if(suggestedProducts.length > 0) {
                <div class="pagination-controls">
                    <button class="btn-pagination" [disabled]="!suggestedCanGoPrev" (click)="suggestedPrevPage()">
                        Previous
                    </button>
                    <span class="page-info">Page {{ suggestedCurrentPage }}</span>
                    <button class="btn-pagination" [disabled]="!suggestedCanGoNext" (click)="suggestedNextPage()">
                        Next
                    </button>
                </div>
                }
                @for (product of suggestedProducts; track product.id) {
                <div class="product-card">
                    <div class="product-image">
                        <img [src]="'https://images.unsplash.com/photo-1558961363-fa8fdf82db35?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=400&q=80'"
                            alt="{{ product.name }}">
                        <button class="favorite-btn" (click)="toggleFavorite(product.id)"
                            [class.active]="isFavorite(product.id)">
                            <i class="fa fa-heart"></i>
                        </button>
                    </div>
                    <div class="product-info">
                        <h3>{{ product.name }}</h3>
                        <div class="product-details">
                            <p class="product-price">€ {{ product.price.toFixed(2) }}</p>
                            <p>Category: {{ product.category }}</p>
                            <p>Shelf: {{ product.shelvingUnit || 'Not assigned' }}</p>
                        </div>
                        <div class="product-rating">
                            <span class="star-rating">
                                @for (i of [1, 2, 3, 4, 5]; track i) {
                                <i class="fa" [ngClass]="{
                    'fa-star': i <= Math.floor(product.averageRating || 0),
                    'fa-star-half-o': (i > Math.floor(product.averageRating || 0) && i <= (product.averageRating || 0) + 0.5),
                    'fa-star-o': i > (product.averageRating || 0) + 0.5
                }"></i>
                                }
                            </span>
                            <span class="rating-value">{{ product.averageRating || 'N/A' }}</span>
                        </div>
                        <div class="product-actions">
                            <button class="btn-view-details" (click)="viewProductDetails(product.id)">
                                View Details
                            </button>
                        </div>
                    </div>
                </div>
                }
            </div>
            }
        </div>
    </div>
</div>

<app-client-footer></app-client-footer>